#!/bin/bash

FILE=${1:-.}

EMACS_SOCKET="tmux$(tmux display -p '#{client_tty}' | sed 's|/|_|g')"

client () {
  emacsclient -nw -s "$EMACS_SOCKET" $FILE
}

server () {
  emacs -nw --daemon="$EMACS_SOCKET"
}

client || (server && client)
